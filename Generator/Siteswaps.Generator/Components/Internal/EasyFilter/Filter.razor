@inherits FluxorComponent
@inject IState<SiteswapGeneratorState> State

@inject IDispatcher Dispatcher
@inject DialogService DialogService

<FilterComponent
    Period="State.Value.State.Period" 
    @bind-Throws="Throws"
    FilterNumber="FilterNumber"
    @bind-IsGlobalPattern="IsGlobalPattern"
    NumberOfJugglers="@(State.Value.State.NumberOfJugglers??2)"
    OnAddFilter="AddFilter">
</FilterComponent>

@code {

    [Parameter]
    public int? FilterNumber { get; set; }

    private bool IsNewFilter => FilterNumber is null;

    [Parameter]
    public List<Throw> Throws { get; set; } = new();

    [Parameter]
    public bool IsGlobalPattern { get; set; } = true;


    private void AddFilter()
    {
        if (IsNewFilter)
        {
            Dispatcher.Dispatch(new NewFilterCreatedAction(new NewPatternFilterInformation(Throws, IsGlobalPattern)));
        }
        else
        {
            Dispatcher.Dispatch(new ChangedFilterAction(new NewPatternFilterInformation(Throws, IsGlobalPattern), FilterNumber!.Value));
        }

        DialogService.Close();
    }
}
